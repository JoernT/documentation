<?xml-model href="http://docbook.org/xml/5.0/rng/docbook.rng"
        schematypens="http://relaxng.org/ns/structure/1.0"?><?xml-model href="http://docbook.org/xml/5.0/rng/docbook.rng" type="application/xml"
        schematypens="http://purl.oclc.org/dsdl/schematron"?>
<article xmlns="http://docbook.org/ns/docbook" version="5.0">
   <info>
      <title>Developer's Guide</title>
      <date>September 2009</date>
      <keywordset>
         <keyword>TBD</keyword>
      </keywordset>
   </info>

   <!-- ================================================================== -->

   <sect1>
      <title>SOAP</title>

      <para>Beginning with version 0.8, eXist-db provides a SOAP interface as an alternative to
                XML-RPC. Programming with SOAP is slightly more convenient than XML-RPC. While you
                have to write XML-RPC method calls by hand, most SOAP tools will automatically
                create the low-level code from a given WSDL service description. Also fewer methods
                are needed to exploit the same functionality. On the other hand, SOAP toolkits tend
                to be complex.</para>
      <para>eXist-db uses the Axis SOAP toolkit from Apache, which runs as a servlet. The Tomcat
                webserver shipped with eXist has been configured to start Axis automatically, and
                will listen on port 8080: <literal>http://localhost:8080/exist/services</literal>.
                Note however that SOAP is not available in the stand-alone server.</para>
      <para>The interface has been tested using various clients, including Perl (SOAP::Lite)
                and the Microsoft .NET framework. The client stubs needed to access the SOAP
                interface from Java have been automatically generated by Axis and are included in
                the distribution.</para>
      <para>eXist-db provides two web services: one that contains methods to query the server and
                retrieve documents, and a second for storing and removing documents and collections.
                The first will by default listen on:</para>
      <programlisting>http://localhost:8080/exist/services/Query</programlisting>
      <para>while the second is available on:</para>
      <programlisting>http://localhost:8080/exist/services/Admin</programlisting>
      <para>Both services are described in the Java docs regarding their interfaces. Visit:
                    <link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://exist-db.org/api/org/exist/soap/Query.html">org.exist.soap.Query</link> and
                    <link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://exist-db.org/api/org/exist/soap/Admin.html">org.exist.soap.Admin</link> for more
                information.</para>
      <para>The following SOAP example (available at:
                    <literal>samples/org/exist/examples/soap/GetDocument.java</literal>)
                demonstrates how to retrieve a document from the database:</para>
      <example>
         <title>Retrieving a document (SOAP)</title>
         <programlisting xmlns:xlink="http://www.w3.org/1999/xlink" language="java" xlink:href="listings/listing-3.txt"/>
      </example>
      <para>In this example, the <literal>Query</literal> client stub class has been
                automatically generated by the WSDL service description, and has methods for each of
                the operations defined in WSDL. You will find the web service description file
                    <literal>query.wsdl</literal> in directory <literal>src/org/exist/soap</literal>. You may also get the WSDL
                directly from the server by pointing your web browser to <link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://localhost:8080/exist/services/Query?WSDL">
                    http://localhost:8080/exist/services/Query?WSDL</link>.</para>
      <para>To use the services provided, the client first has to establish a connection with
                the database. This is done by calling <literal>connect()</literal> with a
                valid user id and password. <literal>connect()</literal> returns a session id,
                which can then be passed to any subsequent method calls.</para>
      <para>To retrieve a resource we simply call
                <literal>Query.getResource()</literal>. And to release the current session,
                the method <literal>Query.disconnect()</literal> is called. Otherwise the
                session will remain valid for at least 60 minutes.</para>
   </sect1>
</article>